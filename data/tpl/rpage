[[= ttabs('r', $d{rel}) ]]
<h2>[[: $p{PageTitle} ]]</h2>
[[ if($d{rel}{original}) { ]]<h3 class="alttitle">[[: $d{rel}{original} ]]</h3>[[ } ]]

[[ if($d{rel}{hidden}) { ]]-
 <span class="warning">
  This item has been deleted from the database. File a request on the
  <a href="/t/v[[= $d{rel}{vn}[0]{vid} ]]">discussion board</a> to undelete this page.
 </span>
[[ } ]]
[[ if(!$d{rel}{hidden} || $p{Authdel}) { ]]-

-[[ if($p{AuthLoggedin}) { ]]
<p class="mod">&lt;
<a href="/u[[= $p{AuthId} ]]/list" rel="rlistDD[[= $d{rel}{id} ]]" class="dropdown">
[[= !$d{rel}{rlist} ? 'not in your list' : "$$VNDB::RSTAT[$d{rel}{rlist}{rstat}] / $$VNDB::VSTAT[$d{rel}{rlist}{vstat}]" ]]
</a> &gt;</p>
[[= rlist_dd($d{rel}) ]]
[[ } ]]-


-[[ if($d{change}) { ]]
[[= cdiff($d{prev}, $d{rel}, 
  [ vn        => 'Relations',    sub { join("<br />\n", map { $_->{title} } @{$_[0]}) } ],
  [ type      => 'Type',         sub { $VNDB::RTYP->[$_[0] ] } ],
  [ title     => 'Title',        1 ],
  [ original  => 'Orig. title',  1 ],
  [ gtin      => 'JAN/UPC/EAN',  1 ],
  [ language  => 'Language',     sub { $VNDB::LANG->{$_[0]} } ],
  [ website   => 'Website',      \&summary ],
  [ released  => 'Release date', \&datestr ],
  [ minage    => 'Age rating',   sub { $VNDB::VRAGES->{$_[0]} } ],
  [ notes     => 'Notes',        1, 1 ],
  [ platforms => 'Platforms',    sub { join(', ', sort @{$_[0]}) } ],
  [ media     => 'Media',        \&mediastr ],
  [ producers => 'Producers',    sub { join(', ', map { _hchar($_->{name}) } sort { $a->{name} cmp $b->{name} } @{$_[0]}) } ],
 ) ]]
[[ } ]]

<dl>
 <dt>Relation</dt><dd>[[= join('<br />', map { '<a href="/v'.$_->{vid}.'" title="'._hchar($_->{original}||$_->{title}).'">'._hchar($_->{title}).'</a>' } @{$d{rel}{vn}}) ]]</dd>
 <dt>Type</dt><dd>[[: $VNDB::RTYP->[$d{rel}{type}] ]]</dd>
 <dt>Language</dt><dd>[[: $VNDB::LANG->{$d{rel}{language}} ]]</dd>
 <dt>Release date</dt><dd>[[= datestr($d{rel}{released}) ]]</dd>
[[ if($d{rel}{gtin}) { ]]-
 <dt>[[: VNDB::GTINType($d{rel}{gtin}) ]]- code</dt><dd>[[= $d{rel}{gtin} ]]</dd>[[ } ]]-
[[ if($d{rel}{minage} >= 0) { ]]-
 <dt>Age rating</dt><dd>[[: $VNDB::VRAGES->{$d{rel}{minage}} ]]</dd>[[ } ]]-
[[ if($#{$d{rel}{producers}} >= 0) { ]]-
 <dt>Producer[[: $#{$d{rel}{producers}} > 0 ? 's' : '' ]]</dt><dd>[[= join(', ', map {
   sprintf('<a href="/p%d" title="'._hchar($_->{original}||$_->{name}).'">%s</a>', $_->{id}, _hchar($_->{name})) } @{$d{rel}{producers}})
 ]]</dd>[[ } ]]-
[[ if($#{$d{rel}{platforms}} >= 0) { ]]-
 <dt>Platform[[: $#{$d{rel}{platforms}} > 0 ? 's' : '' ]]</dt><dd>[[: join(', ', map {
   $VNDB::PLAT->{$_} } @{$d{rel}{platforms}}) ]]</dd>[[ } ]]-
[[ if($#{$d{rel}{media}} >= 0) { ]]-
 <dt>Medi[[: $#{$d{rel}{media}} > 0 ? 'a' : 'um' ]]</dt><dd>[[: mediastr($d{rel}{media}) ]]</dd>[[ } ]]-
[[ if($d{rel}{website}) { ]]-
 <dt>Links</dt><dd><a href="[[: $d{rel}{website} ]]">Official website</a></dd>[[ } ]]-
</dl>

[[ if($d{rel}{notes}) { ]]-
<p>[[= summary($d{rel}{notes}) ]]<br /><br /></p>
[[ } ]]-



[[ } ]]
