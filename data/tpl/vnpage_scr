<h3>Screenshots
[[ if((!$d{vn}{locked} && $p{Authedit}) || $p{Authlock}) { ]]- <p class="actions">(<a href="/v[[= $d{vn}{id} ]]/edit?fh=scr">manage screenshots</a>)</p>[[ } ]]</h3>

[[ if(@{$d{vn}{screenshots}}) {
  my $tot = @{$d{vn}{screenshots}};
  my $nsfw = grep $$_{nsfw}, @{$d{vn}{screenshots}};
]]-

<div id="screenshots">
[[ for my $r (undef, @{$d{rel}}) {
     my @s = grep { !$r && !$_->{rid} || $r && $_->{rid} && $_->{rid} == $r->{id} } @{$d{vn}{screenshots}};
     next if !@s;
]]-
[[ if($r) { ]]
<b><acronym class="icons lang -[[= $r->{language} ]]" title="[[: $VNDB::LANG->{$r->{language}} ]]">&nbsp;</acronym>
[[: $r->{title} ]]</b>
[[ } ]]
[[ for(@s) { ]]
 <a href="[[= sprintf '%s/sf/%02d/%d.jpg', $p{st}, $$_{id}%100, $$_{id} ]]"
  class="shot [[= $$_{nsfw} ? ' scr_nsfw':'' ]]" [[= !$p{AuthNsfw}&&$$_{nsfw}?' style="display: none"':'' ]]-
  rel="[[= $$_{width}.'x'.$$_{height} ]]"><img src="[[= sprintf '%s/st/%02d/%d.jpg', $p{st}, $$_{id}%100, $$_{id} ]]"
 /><b>[[= $$_{nsfw} ? 'x' : '&nbsp;' ]]</b></a>
[[ } ]]-
<br style="clear: left" /><br />
[[ } ]]

</div>
[[ if($nsfw) { ]]-
<p id="scrNsfwHid">&nbsp;</p>
<i style="font-size: 10px;">Items marked with a red X are flagged as NSFW.</i>
[[ } ]]-

[[ } else { ]]-
<p>
 No screenshots have been uploaded yet for this visual novel.
</p>
[[ } ]]
